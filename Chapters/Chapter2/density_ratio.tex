% !TEX root = ../../main.tex
\section{Change-detection by Density-Ratio Estimation}\label{sec:density-ratio}

% Papers:
% \begin{itemize}
%   \item Change-Point Detection in Time-Series Data by Direct Density-Ratio Estimation, 2009, 45 refs \cite{kawahara2009change}
%   \item Change-Point Detection in Time-Series Data by Relative Density-Ratio Estimation, 2013, 3 refs \cite{liu2013change}
%   \item Density ratio estimation in machine learning (Book), 2009, 24 refs \cite{sugiyama2012density}
%   \item Direct importance estimation for covariate shift adaptation, 2008, 84 refs \cite{sugiyama2008direct}
% \end{itemize}

% Formulate the problem of detecting change in the statistical framework.
% Consider the probability distributions from which two consecutive segments of time series around a target time point are generated.
% When the disitrubtions differ significantly the target time point is regarded as a change point.




% CUSUM (cumulative sum) \cite{basseville1993detection} and GLR (generalized likelihood ratio)


% The distribution over the values of time series data can be represented with a probability density function (pdf).
% Two sections of a time series data can be generated with the same underlying pdf or each with a different.

Many approaches to detect change points monitor the logarithm of the likelihood ratio between two consecutive intervals.
A change point is regarded to be the moment in time when the underlying probabilistic generation function changes.
Some methods which rely on this are novelty detection, maximum-likelihood estimation and online learning of autoregressive models \cite{kawahara2009change}.
A limitation of these methods is that they rely on pre-specified parametric models.
Nonparametric models, for which the number and nature of the parameters are undetermined, for density estimation have been proposed, but it is said to be a hard problem \cite{hardle2004nonparametric, sugiyama2012density}.
A solution to this is to estimate the \emph{ratio} of probabilities instead of the probabilities themselves.
One of the recent methods to achieve this is the \gls{kliep} by Sugiyama \etal \cite{sugiyama2008direct}.

The method proposed by Kawahara and Sugiyama~\cite{kawahara2009change} is composed of an online version of the \gls{kliep} algorithm.
The method also considers \emph{sequences} of samples (rather than samples directly) because the time series samples are generally not independent over time.
An advantage over other nonparametric approaches, such as sequential one-class support vector machines, is that the model has a natural cross-validation procedure.
This makes that the value of tuning parameters, such as the kernel bandwidth, can be objectively obtained.

In their formulation change is detected by monitoring the logarithm of the likelihood ratio between the reference (past) and test (current) time intervals
\begin{equation}
  S = \sum_{i=1}^{n_\text{te}} \text{ln} \frac{p_{\text{te}}(\matrixsym{Y}_\text{te}(i)}{p_\text{rf}(\matrixsym{Y}_\text{te}(i))}
\end{equation}
Where $\matrixsym{Y}_\text{te}(i)$ is a sequence of samples from the test interval.
A change is detected when $S > \mu$, for some predetermined threshold $\mu$.
The question is then how to calculate the density ratio
\begin{equation}
  w(\matrixsym{Y}) := \frac{p_\text{te}(\matrixsym{Y)})}{p_\text{rf}(\matrixsym{Y})}
\end{equation}
because this ratio is unknown and should be estimated.
The naive approach is to estimate the ratio by taking the ratio of the estimated densities.
Since this is known to be a hard problem and sensitive for errors, the solution would be to estimate the ratio directly.

The procedure of the method proposed by Kawahara and Sugiyama \cite{kawahara2009change} is to first apply the batch \gls{kliep} algorithm with model selection for initial parameter $\vectorsym{\alpha}$ and kernel width calculation.
Then for every new sample the reference and test intervals are shifted and the calculated parameters $\vectorsym{\alpha}$ are updated.
Finally the logarithm of the likelihood ratio is evaluated.
If it is above the threshold $\mu$ the current time is reported as a change point.

Improvements in this line of research by Liu \etal \cite{liu2013change} has led the application of improved density-ratio estimation methods to the problem of change detection.
Such an improvement is the Unconstrained Least-Squares Importance Fitting (uLSIF) method \cite{kanamori2009least} and an extension which possesses a superior nonparametric convergence property: Relative uLSIF (RuLSIF) \cite{yamada2013relative}.